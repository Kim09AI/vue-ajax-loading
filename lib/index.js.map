{"version":3,"sources":["webpack:///webpack/bootstrap 358f3c12524c63ff007d","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///external \"babel-runtime/helpers/defineProperty\"","webpack:///external \"babel-runtime/regenerator\"","webpack:///external \"babel-runtime/core-js/object/keys\"","webpack:///external \"babel-runtime/core-js/object/entries\"","webpack:///external \"babel-runtime/helpers/asyncToGenerator\"","webpack:///./src/lib/utils.js","webpack:///./src/lib/service-proxy.js","webpack:///./src/lib/index.js","webpack:///external \"vue\"","webpack:///external \"babel-runtime/helpers/slicedToArray\"","webpack:///external \"babel-runtime/core-js/get-iterator\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","require","isObject","obj","toString","isArray","arr","Array","checkUnique","target","keys__default","forEach","key","console","warn","serviceProxy","store","arguments","length","undefined","childProxy","prop","Proxy","_ref","_this","this","_len","args","_key","promise__default","a","asyncToGenerator__default","regenerator__default","mark","_callee","resolve","reject","result","hasError","wrap","_context","prev","next","commit","status","apply","sent","t0","stop","_x2","_x3","_ref8","service","_ref8$loadingProp","loadingProp","finallyService","global","isProd","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","get_iterator__default","entries__default","done","_ref2","value","_ref3","slicedToArray__default","namespace","_module","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_ref4","_ref5","func","err","return","getFinallyService","loadingState","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_ref6","_ref7","val","moduleLoading","getLoadingState","Vue","state","loading","process","loadingMutations","defineProperty__default","_loadingMutations","_ref9","_ref9$status"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"fl6T\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 358f3c12524c63ff007d","module.exports = require(\"babel-runtime/core-js/promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/promise\"\n// module id = /Y4+\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/defineProperty\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/defineProperty\"\n// module id = 4xXb\n// module chunks = 0","module.exports = require(\"babel-runtime/regenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/regenerator\"\n// module id = G4N/\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/object/keys\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/object/keys\"\n// module id = HHX7\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/object/entries\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/object/entries\"\n// module id = TglH\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/asyncToGenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/asyncToGenerator\"\n// module id = ZrOi\n// module chunks = 0","export const isObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]'\r\n\r\nexport const isArray = (arr) => Array.isArray(arr)\r\n\r\nexport function checkUnique(target, obj) {\r\n    Object.keys(obj).forEach(key => {\r\n        if (key in target) {\r\n            console.warn(`存在重复键值 ${key} 后面的会把前面的覆盖`)\r\n        }\r\n    })\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/utils.js","import { isObject } from './utils'\r\n\r\n/**\r\n * 代理请求的方法并自动往 store 设置全局的 loading\r\n * @param {object} obj 要代理的对象\r\n * @param {object} store Vuex.Store 创建的实例\r\n * @param {string} module 模块命名空间\r\n */\r\nfunction serviceProxy(obj, store, module = '') {\r\n    const childProxy = {}\r\n\r\n    Object.keys(obj).forEach(prop => {\r\n        if (isObject(obj[prop])) {\r\n            // 递归代理嵌套对象\r\n            childProxy[prop] = serviceProxy(obj[prop], store, prop)\r\n        }\r\n    })\r\n\r\n    return new Proxy(obj, {\r\n        get(target, prop) {\r\n            if (isObject(target[prop])) {\r\n                return childProxy[prop]\r\n            }\r\n\r\n            if (typeof target[prop] !== 'function') {\r\n                return target[prop]\r\n            }\r\n\r\n            // 通过代理函数自动设置点前请求的 loading 状态\r\n            const proxyFunc = function(...args) {\r\n                return new Promise(async (resolve, reject) => {\r\n                    store.commit('@@loading/SET_LOADING_STATUS', {\r\n                        module,\r\n                        prop,\r\n                        status: true\r\n                    })\r\n    \r\n                    let result\r\n                    let hasError = false\r\n                    try {\r\n                        result = await target[prop](...args)\r\n                    } catch (err) {\r\n                        result = err\r\n                        hasError = true\r\n                    }\r\n    \r\n                    store.commit('@@loading/SET_LOADING_STATUS', {\r\n                        module,\r\n                        prop,\r\n                        status: false\r\n                    })\r\n    \r\n                    hasError ? reject(result) : resolve(result)\r\n                })\r\n            }\r\n\r\n            return proxyFunc\r\n        }\r\n    })\r\n}\r\n\r\nexport default serviceProxy\n\n\n// WEBPACK FOOTER //\n// ./src/lib/service-proxy.js","import Vue from 'vue'\r\nimport { isArray, isObject, checkUnique } from './utils'\r\nimport serviceProxy from './service-proxy'\r\n\r\nconst isProd = process.env.NODE_ENV === 'production'\r\n\r\nfunction getFinallyService({ global, modules }) {\r\n    const finallyService = {}\r\n\r\n    if (isArray(global) || isObject(global)) {\r\n        global = isArray(global) ? global : [global]\r\n\r\n        global.forEach(obj => {\r\n            !isProd && checkUnique(finallyService, obj)\r\n\r\n            for (let prop in obj) {\r\n                finallyService[prop] = obj[prop]\r\n            }\r\n        })\r\n    }\r\n\r\n    if (isObject(modules) && Object.keys(modules).length > 0) {\r\n        !isProd && checkUnique(finallyService, modules)\r\n\r\n        for (let [namespace, value] of Object.entries(modules)) {\r\n            !isObject(finallyService[namespace]) && (finallyService[namespace] = {})\r\n\r\n            const _module = finallyService[namespace]\r\n            for (let [prop, func] of Object.entries(value)) {\r\n                _module[prop] = func\r\n            }\r\n        }\r\n    }\r\n\r\n    return finallyService\r\n}\r\n\r\n/**\r\n * 得到 loading 的初始状态\r\n * @param {object} finallyService 处理过后的 service 对象\r\n */\r\nfunction getLoadingState(finallyService) {\r\n    const loadingState = {}\r\n\r\n    for (let [prop, val] of Object.entries(finallyService)) {\r\n        if (typeof val === 'function') {\r\n            loadingState[prop] = false\r\n        } else {\r\n            const moduleLoading = loadingState[prop] = {}\r\n            Object.keys(val).forEach(key => moduleLoading[key] = false)\r\n        }\r\n    }\r\n\r\n    return loadingState\r\n}\r\n\r\nexport function ajaxLoading({ store, service, loadingProp = '$loading' } = {}) {\r\n    const finallyService = getFinallyService(service)\r\n    const loadingState = getLoadingState(finallyService)\r\n\r\n    // 初始化 loading 的状态\r\n    store.commit('@@loading/INITIAL_LOADING', loadingState)\r\n\r\n    if (typeof Vue.prototype[loadingProp] !== 'undefined') {\r\n        console.warn(`Vue原型上已存在 Vue.prototype.${loadingProp}`)\r\n    }\r\n\r\n    Vue.prototype[loadingProp] = store.state.loading\r\n\r\n    return serviceProxy(finallyService, store)\r\n}\r\n\r\nexport const loadingState = {\r\n    loading: {}\r\n}\r\n\r\nexport const loadingMutations = {\r\n    ['@@loading/INITIAL_LOADING'](state, loading) {\r\n        state.loading = loading\r\n    },\r\n    ['@@loading/SET_LOADING_STATUS'](state, { module, prop, status = false } = {}) {\r\n        !!module\r\n            ? state.loading[module][prop] = status\r\n            : state.loading[prop] = status\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/index.js","module.exports = require(\"vue\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vue\"\n// module id = lRwf\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/slicedToArray\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/slicedToArray\"\n// module id = qI4L\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/get-iterator\"\n// module id = zH1C\n// module chunks = 0"],"sourceRoot":""}